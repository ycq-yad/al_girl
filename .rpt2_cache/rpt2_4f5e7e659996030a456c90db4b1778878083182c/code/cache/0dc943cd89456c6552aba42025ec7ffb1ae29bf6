{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport GameLogicProcessingManager_Als from \"../../../games/GameLogicProcessingManager\";\r\nimport { PlayerDataManager_Als } from \"../../../common/GameDataManager\";\r\nimport ConfigManager_Als from \"../../../games/ConfigManager\";\r\nimport Als_SoundManager from \"../../../common/SoundManager\";\r\nimport { GoodsType } from \"../../../games/CommonDefine\";\r\nimport { MiniManeger_Als } from \"../../../minigame/MiniManeger\";\r\nimport { PopBaseScene } from \"../../base/PopBaseScene\";\r\nimport AnimationManager_Als from \"../../../manager/AnimationManager\";\r\nvar SignView_Als = (function (_super) {\r\n    tslib_1.__extends(SignView_Als, _super);\r\n    function SignView_Als() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"SignView_Als\";\r\n        _this.showEnterType = BasePopAnimationEnterType.SCALE_MODE_BACK;\r\n        _this.als_bIsRunning = false;\r\n        _this.skin = \"game/uiView/SignView.json\";\r\n        return _this;\r\n    }\r\n    SignView_Als.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n    };\r\n    SignView_Als.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        this.als_bIsRunning = false;\r\n        Laya.Tween.clearAll(this.imageBtSign);\r\n        Laya.timer.clearAll(this);\r\n    };\r\n    SignView_Als.prototype.addEvent = function () {\r\n        this.registerEvent(this.imageBtSign, Laya.Event.CLICK, this.onMousClck_Als, this);\r\n        this.registerEvent(this.spBtClose, Laya.Event.CLICK, this.onMousClck_Als, this);\r\n        this.registerEvent(this.boxDouble, Laya.Event.CLICK, this.onMousClck_Als, this);\r\n    };\r\n    SignView_Als.prototype.initView = function () {\r\n        this.als_nCurTime = 0;\r\n        this.als_bDouble = false;\r\n        this.als_bIsRunning = true;\r\n        this.refhSD_Als();\r\n        this.refhSV_Als();\r\n        this.refhSiReBt_Als();\r\n        this.initDb_Als();\r\n        MiniManeger_Als.instance.showBannerAd();\r\n    };\r\n    SignView_Als.prototype.refhSD_Als = function () {\r\n        this.als_nCurTime = GameLogicProcessingManager_Als.GetCurTime();\r\n        if (Utils.judgeIsOnTheSameDay(PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignTimeLast, this.als_nCurTime)) {\r\n            this.btDouble.visible = false;\r\n            return;\r\n        }\r\n        if (PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex >= 7) {\r\n            PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex = 0;\r\n        }\r\n    };\r\n    SignView_Als.prototype.onMousClck_Als = function (evt) {\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        switch (evt.currentTarget) {\r\n            case this.spBtClose:\r\n                this.removeSelf();\r\n                break;\r\n            case this.imageBtSign:\r\n                this.onSid_Als();\r\n                break;\r\n            case this.boxDouble:\r\n                this.onSigDb_Als();\r\n                break;\r\n        }\r\n    };\r\n    SignView_Als.prototype.onSigDb_Als = function () {\r\n        this.spDouble.visible = !this.spDouble.visible;\r\n        this.als_bDouble = !this.spDouble.visible;\r\n    };\r\n    SignView_Als.prototype.refreshSignInfoSix = function (stImageTemp, stData) {\r\n        var stSpriteGoods = stImageTemp.getChildAt(2);\r\n        if (stSpriteGoods) {\r\n            var str = '';\r\n            if (stData.nType == 1) {\r\n                str = \"resource/assets/img/common/maininterface_icon_7.png\";\r\n            }\r\n            else if (stData.nType == 2) {\r\n                str = \"resource/assets/img/common/maininterface_icon_6.png\";\r\n            }\r\n            stSpriteGoods.loadImage(str);\r\n        }\r\n        var stBox = stImageTemp.getChildByName(\"boxWorld\");\r\n        if (stBox) {\r\n            var spNum = stBox.getChildByName(\"spWorld\");\r\n            if (spNum) {\r\n                BitmapLabelUtils.setLabel(spNum, stData.nCount.toString(), \"resource/assets/img/common/level_number1/level_number1_\", 0, \".png\", \"left\");\r\n            }\r\n        }\r\n    };\r\n    SignView_Als.prototype.isSigned = function (stImageTemp, i) {\r\n        var spSigned = stImageTemp.getChildByName(\"spSigned\");\r\n        if (spSigned) {\r\n            if (i < PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex) {\r\n                spSigned.visible = true;\r\n            }\r\n            else {\r\n                spSigned.visible = false;\r\n            }\r\n        }\r\n    };\r\n    SignView_Als.prototype.initDb_Als = function () {\r\n        if (BaseConst.infos.gameInfo.openPsAward && BaseConst.infos.gameInfo.openPsAward == 1) {\r\n            this.spDouble.visible = false;\r\n        }\r\n        else {\r\n            this.spDouble.visible = true;\r\n        }\r\n        this.als_bDouble = !this.spDouble.visible;\r\n    };\r\n    SignView_Als.prototype.refhSV_Als = function () {\r\n        var arySignData = ConfigManager_Als.getInstance().getSignDataAll();\r\n        var nLen = arySignData.length;\r\n        var stImageTemp = null;\r\n        var stSpriteGoods = null;\r\n        for (var i = 0; i < nLen; ++i) {\r\n            stImageTemp = this.boxItem.getChildAt(i);\r\n            if (stImageTemp) {\r\n                if (i < 6) {\r\n                    this.refreshSignInfoSix(stImageTemp, arySignData[i]);\r\n                }\r\n                else {\r\n                    BitmapLabelUtils.setLabel(this.spWorldLeft, arySignData[i].nCount.toString(), \"resource/assets/img/common/level_number1/level_number1_\", 0, \".png\", \"left\");\r\n                    BitmapLabelUtils.setLabel(this.spWorldRight, arySignData[i].nCount7.toString(), \"resource/assets/img/common/level_number1/level_number1_\", 0, \".png\", \"left\");\r\n                }\r\n                this.isSigned(stImageTemp, i);\r\n            }\r\n        }\r\n    };\r\n    SignView_Als.prototype.onSid_Als = function () {\r\n        if (this.als_bDouble) {\r\n            var self_1 = this;\r\n            MiniManeger_Als.instance.playViderAd({\r\n                successFun: function () {\r\n                    self_1.pSData_Als();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.pSData_Als();\r\n        }\r\n    };\r\n    SignView_Als.prototype.refhSiReBt_Als = function () {\r\n        this.als_nCurTime = GameLogicProcessingManager_Als.GetCurTime();\r\n        ;\r\n        this.boxDouble.visible = true;\r\n        this.btDouble.visible = true;\r\n        this.spTomorrow.visible = true;\r\n        this.imageBtSign.visible = true;\r\n        if (Utils.judgeIsOnTheSameDay(PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignTimeLast, this.als_nCurTime)) {\r\n            this.boxDouble.visible = false;\r\n            this.btDouble.visible = false;\r\n            this.imageBtSign.visible = false;\r\n        }\r\n        else {\r\n            this.spTomorrow.visible = false;\r\n            this.startSIBTSA_Als();\r\n        }\r\n    };\r\n    SignView_Als.prototype.refreshSignUIData = function () {\r\n        var stSignData = ConfigManager_Als.getInstance().getSignDataBySignID(PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex);\r\n        if (stSignData) {\r\n            var nValue = stSignData.nCount;\r\n            if (this.als_bDouble) {\r\n                nValue *= 2;\r\n            }\r\n            PlayerDataManager_Als.getInstance().AddGoods(stSignData.nType, nValue);\r\n            if (stSignData.nType == GoodsType.enum_GoodsType_Sp) {\r\n                TipsManager.getInstance().showDefaultTips(\"体力+\" + nValue.toString());\r\n            }\r\n            if (PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex == 6) {\r\n                var nValue_1 = stSignData.nCount7;\r\n                if (this.als_bDouble) {\r\n                    nValue_1 *= 2;\r\n                }\r\n                PlayerDataManager_Als.getInstance().AddGoods(stSignData.nType7, nValue_1);\r\n            }\r\n        }\r\n    };\r\n    SignView_Als.prototype.startSIBTSA_Als = function () {\r\n        Laya.timer.clearAll(this.imageBtSign);\r\n        AnimationManager_Als.instance.zoomTweena(this.imageBtSign, this.imageBtSign);\r\n    };\r\n    SignView_Als.prototype.pSData_Als = function () {\r\n        this.refreshSignUIData();\r\n        PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignIndex += 1;\r\n        PlayerDataManager_Als.getInstance().stPlayerDataBase.nSignTimeLast = GameLogicProcessingManager_Als.GetCurTime();\r\n        PlayerDataManager_Als.getInstance().SaveData();\r\n        this.refhSV_Als();\r\n        this.refhSiReBt_Als();\r\n    };\r\n    return SignView_Als;\r\n}(PopBaseScene));\r\nexport default SignView_Als;\r\n",
  "references": [
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/games/GameLogicProcessingManager.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/common/GameDataManager.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/games/ConfigManager.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/common/SoundManager.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/games/CommonDefine.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/minigame/MiniManeger.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/views/base/PopBaseScene.ts",
    "E:/laya/project/laya_girl_ts_wecat_git/src/script/manager/AnimationManager.ts"
  ]
}
