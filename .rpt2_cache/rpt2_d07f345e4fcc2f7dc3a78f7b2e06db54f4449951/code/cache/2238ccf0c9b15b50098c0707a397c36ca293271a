{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport { Als_GameData } from \"../common/GameData\";\r\nimport InviteManager_Als from \"../manager/InviteManager\";\r\nimport Als_SoundManager from \"../common/SoundManager\";\r\nimport ViewChangeManager_Als from \"../games/ViewChangeManager\";\r\nimport GameEvent_Als from \"../games/GameEvent\";\r\nimport PlatformDY from \"../../PlatformDY\";\r\nimport GuessLike_Als from \"../views/game/GuessLike\";\r\nimport { HttpMgr } from \"../base/net/HttpMgr\";\r\nvar MiniManeger_Als = (function () {\r\n    function MiniManeger_Als() {\r\n        this.hideTime = 0;\r\n        this.showTime = 0;\r\n        this.defaultMssage = {\r\n            \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪！\",\r\n            \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl/Share/500x400-1.jpg?v=\" + 1.0,\r\n            \"query\": \"\"\r\n        };\r\n        this.shareInfo = [\r\n            {\r\n                \"title\": \"烧脑推理，一键过关！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl/Share/500x400-2.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl/Share/500x400-1.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            },\r\n            {\r\n                \"title\": \"机会只有一次！救救女孩！\",\r\n                \"imageUrl\": \"https://package.32yx.com/ecy_game_small/laya/girl/Share/500x400-3.jpg?v=\" + 1.0,\r\n                \"query\": \"\"\r\n            }\r\n        ];\r\n        this.shareInfoDouYin = [\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"烧脑推理，一键过关！\",\r\n                \"desc\": \"烧脑推理，一键过关\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"阿罗斯营救\", \"烧脑推理，一键过关\"]\r\n                }\r\n            },\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪？\",\r\n                \"desc\": \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪？\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"阿罗斯营救\", \"休闲解密游戏，开动你的小脑筋帮助女孩逃离魔爪\"]\r\n                }\r\n            },\r\n            {\r\n                \"channel\": \"video\",\r\n                \"title\": \"机会只有一次！救救女孩！\",\r\n                \"desc\": \"机会只有一次！救救女孩！\",\r\n                \"imageUrl\": \"\",\r\n                \"query\": \"\",\r\n                \"extra\": {\r\n                    \"videoPath\": \"\",\r\n                    \"videoTopics\": [\"阿罗斯营救\", \"机会只有一次！救救女孩！\"]\r\n                }\r\n            }\r\n        ];\r\n        this.bFlagDouYin = false;\r\n        this.sucTime = 0;\r\n        this.canShowBanner = true;\r\n        this.bTimerOpen = false;\r\n        this.bFlagSpecialView = true;\r\n        this.nRecordTime = 60;\r\n        this.nRecordTimeReal = 0;\r\n        this.onShareVideoSuccess = false;\r\n        this.bPushMsgShowFlagTen = false;\r\n        this.bPushMsgShowFlagChooseLevel = false;\r\n        this.stPhoneInfo = null;\r\n        this.strApiUrl = \"https://pv.sohu.com/cityjson?ie=utf-8\";\r\n        this.initVideoInfo();\r\n    }\r\n    Object.defineProperty(MiniManeger_Als, \"instance\", {\r\n        get: function () {\r\n            if (MiniManeger_Als.ins == null) {\r\n                MiniManeger_Als.ins = new MiniManeger_Als();\r\n            }\r\n            return MiniManeger_Als.ins;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MiniManeger_Als.prototype.compareVersion = function (v1, v2) {\r\n        var v1Arr = v1.split(\".\");\r\n        var v2Arr = v2.split(\".\");\r\n        var len = Math.max(v1Arr.length, v2Arr.length);\r\n        while (v1Arr.length < len) {\r\n            v1Arr.push(\"0\");\r\n        }\r\n        while (v2Arr.length < len) {\r\n            v2Arr.push(\"0\");\r\n        }\r\n        for (var i = 0; i < len; i++) {\r\n            var num1 = parseInt(v1Arr[i]);\r\n            var num2 = parseInt(v2Arr[i]);\r\n            if (num1 > num2) {\r\n                return 1;\r\n            }\r\n            else if (num1 < num2) {\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    MiniManeger_Als.prototype.addColorSign = function (data) {\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            if (this.compareVersion(this.systemInfo.SDKVersion, \"1.10.0\") >= 0) {\r\n                qq.addColorSign(data);\r\n            }\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.isColorSignExistSync = function () {\r\n        if (this.compareVersion(this.systemInfo.SDKVersion, \"1.16.0\") >= 0) {\r\n            return qq.isColorSignExistSync();\r\n        }\r\n        else {\r\n            return this.compareVersion(this.systemInfo.SDKVersion, \"1.10.0\") >= 0;\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.initMiniGame = function () {\r\n        var _this = this;\r\n        var launchObj = platform.getLaunchOptionsSync();\r\n        if (launchObj) {\r\n            console.log('launchObj>>>>>>>>>>>>>>', launchObj);\r\n        }\r\n        this.getUpdateManager();\r\n        platform.setKeepScreenOn();\r\n        platform.updateShareMenu();\r\n        platform.showShareMenu();\r\n        platform.onShareAppMessage(function () {\r\n            return _this.defaultMssage;\r\n        });\r\n        this.systemInfo = platform.getSystemInfoSync();\r\n        console.log(\"systemInfo >> \", this.systemInfo);\r\n    };\r\n    MiniManeger_Als.prototype.getUpdateManager = function () {\r\n    };\r\n    MiniManeger_Als.prototype.onAudioInterruptionBegin = function (call) {\r\n    };\r\n    MiniManeger_Als.prototype.onAudioInterruptionEnd = function (call) {\r\n    };\r\n    MiniManeger_Als.prototype.getUserInfo = function () {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            return tslib_1.__generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) {\r\n                        resolve(null);\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.initUserTemp = function () {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var info, strOpenIdOther, strOpenIdOther;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, this.getUserInfo()];\r\n                    case 1:\r\n                        info = _a.sent();\r\n                        if (!(info == null)) return [3, 3];\r\n                        return [4, this.userButtonSize(0, 1, 0)];\r\n                    case 2:\r\n                        info = _a.sent();\r\n                        strOpenIdOther = Als_GameData.getInstance().enterGameInfo.query[\"openid\"];\r\n                        console.log(\"strOpenIdOther = \", strOpenIdOther);\r\n                        if (strOpenIdOther && strOpenIdOther != \"\") {\r\n                            platform.createUserInfoButton(function (data) {\r\n                                Als_GameData.getInstance().userInfo.nick = data.userInfo.nickName;\r\n                                Als_GameData.getInstance().userInfo.avatarUrl = data.userInfo.avatarUrl;\r\n                                if (!BaseConst.infos.gameInfo.isDY) {\r\n                                    InviteManager_Als.getInstance().judgeInvite();\r\n                                    console.log(\"createUserInfoButton 用户信息 : \", Als_GameData.getInstance().userInfo);\r\n                                }\r\n                                info = data;\r\n                            });\r\n                        }\r\n                        return [3, 4];\r\n                    case 3:\r\n                        Als_GameData.getInstance().userInfo.nick = info.userInfo.nickName;\r\n                        Als_GameData.getInstance().userInfo.avatarUrl = info.userInfo.avatarUrl;\r\n                        strOpenIdOther = Als_GameData.getInstance().enterGameInfo.query[\"openid\"];\r\n                        console.log(\"strOpenIdOther = \", strOpenIdOther);\r\n                        if (strOpenIdOther && strOpenIdOther != \"\") {\r\n                            InviteManager_Als.getInstance().judgeInvite();\r\n                            console.log(\"createUserInfoButton 用户信息 judgeInvite: \", Als_GameData.getInstance().userInfo);\r\n                        }\r\n                        _a.label = 4;\r\n                    case 4:\r\n                        MiniManeger_Als.instance.defaultMssage.query = \"openid=\" + Als_GameData.getInstance().userInfo.openId;\r\n                        platform.onShareAppMessage(function () {\r\n                            return MiniManeger_Als.instance.defaultMssage;\r\n                        });\r\n                        return [2, info];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.userButtonSize = function (percentTop, pectendSize, percentLeft) {\r\n        var resInfo = platform.getSystemInfoSync();\r\n        var left = resInfo['windowWidth'] * percentLeft;\r\n        var top = resInfo['windowHeight'] * percentTop;\r\n        var wid = resInfo['windowWidth'] * pectendSize;\r\n        var height = resInfo['windowHeight'] * pectendSize;\r\n    };\r\n    MiniManeger_Als.prototype.onShow = function (callBack) {\r\n        var _this = this;\r\n        platform.onShow(function () {\r\n            callBack && callBack();\r\n            if (!DeviceUtil.isTTMiniGame()) {\r\n                _this.showTime = new Date().getTime();\r\n                if (_this.showTime - _this.hideTime >= _this.sucTime) {\r\n                    _this.shareSucful && _this.shareSucful.call(_this.thisObj);\r\n                }\r\n                else {\r\n                    _this.shareFailful && _this.shareFailful.call(_this.thisObj);\r\n                }\r\n            }\r\n            _this.shareSucful = null;\r\n            _this.shareFailful = null;\r\n            _this.thisObj = null;\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.onHide = function (callBack) {\r\n        var _this = this;\r\n        platform.onHide(function () {\r\n            callBack && callBack();\r\n            _this.hideTime = new Date().getTime();\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.showMoreGame = function (data) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n                        return tslib_1.__generator(this, function (_a) {\r\n                            return [2];\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.getShareInfo = function (query) {\r\n        var shareInfo = this.shareInfo;\r\n        var info = shareInfo[Math.floor(Math.random() * shareInfo.length)];\r\n        if (query) {\r\n            var openId = Als_GameData.getInstance().userInfo.openId;\r\n            query['openid'] = openId;\r\n        }\r\n        info.query = Utils.querStr(query);\r\n        return info;\r\n    };\r\n    MiniManeger_Als.prototype.testShareVideo = function () {\r\n        var obj = {\r\n            channel: \"video\",\r\n            title: \"测试分享视频\",\r\n            desc: \"测试描述\",\r\n            imageUrl: \"\",\r\n            templateId: \"\",\r\n            query: \"\",\r\n            extra: {\r\n                videoPath: \"ttfile://temp/test.mp4\",\r\n                videoTopics: [\"话题11\", \"话题21\"]\r\n            },\r\n            success: function () {\r\n                console.log(\"分享视频成功\");\r\n            },\r\n            fail: function (e) {\r\n                console.log(\"分享视频失败\");\r\n            }\r\n        };\r\n        obj.extra.videoPath = this.strVideoPatch;\r\n        platform.shareAppMessage(obj);\r\n    };\r\n    MiniManeger_Als.prototype.getShareInfoDouYin = function (query) {\r\n        var shareInfo = this.shareInfoDouYin;\r\n        var info = shareInfo[Math.floor(Math.random() * shareInfo.length)];\r\n        if (query) {\r\n            var openId = Als_GameData.getInstance().userInfo.openId;\r\n            query['openid'] = openId;\r\n        }\r\n        info.query = Utils.querStr(query);\r\n        info.extra.videoPath = this.strVideoPatch;\r\n        return info;\r\n    };\r\n    MiniManeger_Als.prototype.shareAppMessage = function (data) {\r\n        if (data == null) {\r\n            data = {};\r\n        }\r\n        if (!data.message) {\r\n            data.message = this.getShareInfo({});\r\n        }\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN' && this.bFlagDouYin) {\r\n                data.message = this.getShareInfoDouYin({});\r\n                console.log(\"data.message = \", data.message);\r\n            }\r\n            if (data.sucFun) {\r\n                data.sucFun && (data.message.success = data.sucFun);\r\n            }\r\n            else {\r\n                data.message.success = function () {\r\n                    TipsManager.getInstance().showDefaultTips('分享成功');\r\n                };\r\n            }\r\n            if (data.failFun) {\r\n                data.failFun && (data.message.fail = data.failFun);\r\n            }\r\n            else {\r\n                data.message.fail = function () {\r\n                    TipsManager.getInstance().showDefaultTips('分享失败');\r\n                };\r\n            }\r\n            platform.shareAppMessage(data.message);\r\n            return;\r\n        }\r\n        this.shareSucful = data.sucFun;\r\n        this.shareFailful = function () {\r\n            data.failFun && data.failFun();\r\n            ;\r\n        };\r\n        this.thisObj = data.thisObj;\r\n        this.sucTime = data.time || 3000;\r\n        if (DeviceUtil.isWXMiniGame() || DeviceUtil.isQQMiniGame()) {\r\n            platform.shareAppMessage(data.message);\r\n        }\r\n        else {\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.playViderAd = function (data) {\r\n        if (!DeviceUtil.isMiniGame()) {\r\n            data.successFun && data.successFun();\r\n            return;\r\n        }\r\n        var videoId = Als_GameData.getInstance().videoId;\r\n        if (data.isLongVideo) {\r\n            videoId = Als_GameData.getInstance().longVideoId;\r\n        }\r\n        if (videoId.length <= 0) {\r\n            TipsManager.getInstance().showDefaultTips('开发中');\r\n            data.errorFun && data.errorFun();\r\n            return;\r\n        }\r\n        ViewChangeManager_Als.getInstance().showBufferLoadingView();\r\n        var adId = videoId[Math.floor(Math.random() * videoId.length)];\r\n        platform.createRewardedVideoAd(adId, function (res) {\r\n            if (res.isEnded) {\r\n                data.successFun && data.successFun();\r\n                if (!DeviceUtil.isTTMiniGame()) {\r\n                    Als_SoundManager.getInstance().playBgMusic();\r\n                }\r\n                console.log(\" video normal！\");\r\n            }\r\n            else {\r\n                data.failFun && data.failFun();\r\n                if (!DeviceUtil.isTTMiniGame()) {\r\n                    Als_SoundManager.getInstance().playBgMusic();\r\n                }\r\n                console.log(\" video not finish！\");\r\n            }\r\n            ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n        }, function () {\r\n            ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n            TipsManager.getInstance().showDefaultTips('网络错误');\r\n            data.errorFun && data.errorFun();\r\n            if (!DeviceUtil.isTTMiniGame()) {\r\n                Als_SoundManager.getInstance().playBgMusic();\r\n            }\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.showBannerAd = function (offset) {\r\n        if (!DeviceUtil.isMiniGame()) {\r\n            return;\r\n        }\r\n        if ((this.isWxMiniGameForOperReq() || DeviceUtil.isQQMiniGame()) && !this.bFlagSpecialView) {\r\n            return;\r\n        }\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n        }\r\n        this.canShowBanner = true;\r\n        var bannerId = Als_GameData.getInstance().bannerId;\r\n        if (bannerId.length <= 0) {\r\n            console.log(\"bannerId.length <= 0\");\r\n            return;\r\n        }\r\n        var adId = bannerId[Math.floor(Math.random() * bannerId.length)];\r\n        if (this.bannerAd == null) {\r\n            var bannerAd = platform.createBannerAd(adId);\r\n            this.bannerAd = bannerAd;\r\n            if (bannerAd == null)\r\n                return;\r\n            bannerAd.show();\r\n            this.nBannerLeft = this.bannerAd.style.left;\r\n            this.nBannerTop = this.bannerAd.style.top;\r\n            console.log(\"this.nBannerLeft = \", this.nBannerLeft, \" this.nBannerTop = \", this.nBannerTop);\r\n        }\r\n        else {\r\n        }\r\n        this.bannerAd.show();\r\n        if (!this.canShowBanner) {\r\n            this.bannerAd.hide();\r\n        }\r\n        if (offset) {\r\n            this.bannerAd.style.left = offset.w - this.bannerAd.style.realWidth / 2 + 0.1;\r\n            this.bannerAd.style.top = offset.h - this.bannerAd.style.realHeight + 0.1;\r\n            offset.callback && offset.callback();\r\n        }\r\n        if (DeviceUtil.isQQMiniGame() || this.isWxMiniGameForOperReq()) {\r\n            this.qqRefreshBinner();\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.qqRefreshBinnerReadl = function () {\r\n        if (!this.bFlagSpecialView) {\r\n            return;\r\n        }\r\n        if (DeviceUtil.isQQMiniGame() || this.isWxMiniGameForOperReq()) {\r\n            var bannerId = Als_GameData.getInstance().bannerId;\r\n            if (bannerId.length <= 0) {\r\n                console.log(\"bannerId.length <= 0\");\r\n                return;\r\n            }\r\n            var adId = bannerId[Math.floor(Math.random() * bannerId.length)];\r\n            platform.binnerDestroy();\r\n            this.bannerAd = null;\r\n            var bannerAd = platform.createBannerAd(adId);\r\n            this.bannerAd = bannerAd;\r\n            this.showBannerAd();\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.qqRefreshBinner = function () {\r\n        if (this.bTimerOpen) {\r\n            return;\r\n        }\r\n        this.bTimerOpen = true;\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            Laya.timer.clear(this, this.qqRefreshBinnerReadl);\r\n            Laya.timer.loop(30000, this, this.qqRefreshBinnerReadl);\r\n        }\r\n        else if (this.isWxMiniGameForOperReq()) {\r\n            Laya.timer.clear(this, this.qqRefreshBinnerReadl);\r\n            Laya.timer.loop(BaseConst.infos.gameInfo.binnertime, this, this.qqRefreshBinnerReadl);\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.hideBanner = function () {\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n        }\r\n        if (this.bannerAd != null) {\r\n            this.bannerAd.hide();\r\n        }\r\n        this.canShowBanner = false;\r\n    };\r\n    MiniManeger_Als.prototype.resetBinnerOper = function () {\r\n        if (!this.stPhoneInfo) {\r\n            this.stPhoneInfo = platform.getSystemInfoSync();\r\n        }\r\n        if (this.bannerAd) {\r\n            this.bannerAd.style.left = this.stPhoneInfo.screenWidth / 2 - this.bannerAd.style.realWidth / 2 + 0.1;\r\n            this.bannerAd.style.top = this.stPhoneInfo.screenHeight - this.bannerAd.style.realHeight + 0.1;\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.adaptImgToClientRect = function (collec_img, stage) {\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            var systemInfo = platform.getSystemInfoSync();\r\n            var screenHeight = systemInfo['screenHeight'];\r\n            var screenWidth = systemInfo['screenWidth'];\r\n            var rect = platform.getMenuButtonBoundingClientRect();\r\n            collec_img.top = stage.height * (rect['top'] / screenHeight);\r\n            collec_img.right = stage.width * (1 - rect['right'] / screenWidth) + collec_img.width;\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.sendDataToWxOpen = function (data) {\r\n        Laya.MiniAdpter.window.wx.postMessage(data);\r\n    };\r\n    MiniManeger_Als.prototype.removeOpenData = function (data) {\r\n        var wxOpenData = data.parent.getChildByName('wxOpenData');\r\n        this.sendDataToWxOpen({ cmd: 'close', data: null });\r\n        if (wxOpenData) {\r\n            wxOpenData.removeSelf();\r\n            wxOpenData.destroy();\r\n            wxOpenData = null;\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.addOpenWxData = function (data) {\r\n        var shareData = MiniManeger_Als.instance.getShareInfo({ id: Als_GameData.getInstance().userInfo.openId });\r\n        this.sendDataToWxOpen({ cmd: 'share', data: JSON.stringify(shareData) });\r\n        var wxOpenData = data.parent.getChildByName('wxOpenData');\r\n        if (wxOpenData) {\r\n            wxOpenData.removeSelf();\r\n            wxOpenData.destroy();\r\n            wxOpenData = null;\r\n        }\r\n        wxOpenData = new Laya.WXOpenDataViewer();\r\n        wxOpenData.name = 'wxOpenData';\r\n        wxOpenData.x = data.x || 0;\r\n        wxOpenData.y = data.y || 0;\r\n        wxOpenData.width = data.width;\r\n        wxOpenData.height = data.height;\r\n        if (data.isCenter) {\r\n            wxOpenData.centerX = 0;\r\n            wxOpenData.centerY = 0;\r\n        }\r\n        else {\r\n            if (data.left != null) {\r\n                wxOpenData.left = data.left;\r\n            }\r\n            if (data.right != null) {\r\n                wxOpenData.right = data.right;\r\n            }\r\n            if (data.top != null) {\r\n                wxOpenData.top = data.top;\r\n            }\r\n            if (data.bottom != null) {\r\n                wxOpenData.bottom = data.bottom;\r\n            }\r\n        }\r\n        if (data.parent) {\r\n            data.parent.addChild(wxOpenData);\r\n        }\r\n        return wxOpenData;\r\n    };\r\n    MiniManeger_Als.prototype.initBoxAd = function () {\r\n        var _this = this;\r\n        if (!this.tempBoxAD) {\r\n            this.tempBoxAD = platform.createAppBox(Als_GameData.getInstance().boxId[0]);\r\n            this.tempBoxAD.load().then(function (res) {\r\n                console.log(\"boxAd load\");\r\n                console.log(res);\r\n            }).catch(function (err) {\r\n                console.log(\"boxAd load err\");\r\n                console.log(err);\r\n            });\r\n            this.tempBoxAD.onClose(function () {\r\n                _this.imgRect && _this.imgRect.removeSelf();\r\n                _this.onCloseBoxAD && _this.onCloseBoxAD();\r\n            });\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.showBoxAd = function (onCloseCall) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                this.onCloseBoxAD = onCloseCall;\r\n                if (DeviceUtil.isQQMiniGame()) {\r\n                    if (!this.imgRect) {\r\n                        this.imgRect = new Laya.Image(ResUtil.getIntance().getOriginUrlPath(ResUtil.getIntance().getResInfoByName(\"game_panel_db_png\").url));\r\n                        this.imgRect.sizeGrid = \"3,3,2,2\";\r\n                        this.imgRect.width = Laya.stage.width;\r\n                        this.imgRect.height = Laya.stage.height;\r\n                    }\r\n                    Laya.stage.addChild(this.imgRect);\r\n                    if (this.tempBoxAD) {\r\n                        this.tempBoxAD.show().then(function (res) {\r\n                            console.log(\"boxAd show\");\r\n                            console.log(res);\r\n                        }).catch(function (err) {\r\n                            console.log(\"boxAd show err\");\r\n                            console.log(err);\r\n                            _this.imgRect && _this.imgRect.removeSelf();\r\n                            _this.onCloseBoxAD && _this.onCloseBoxAD();\r\n                        });\r\n                    }\r\n                }\r\n                return [2];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.initVideoInfo = function () {\r\n        var _this = this;\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        this.recorder = platform.getGameRecorderManager();\r\n        this.recorder.onStart(function (res) {\r\n            console.log(\"onStart -> \", res);\r\n        });\r\n        this.recorder.onStop(function (res) {\r\n            _this.strVideoPatch = res.videoPath;\r\n            if (_this.nRecordTimeReal < 3000)\r\n                _this.strVideoPatch = null;\r\n            console.log(\"onStop ->\", _this.strVideoPatch);\r\n            MiniManeger_Als.instance.saveCallF && MiniManeger_Als.instance.saveCallF();\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.StartRecorderVideo = function () {\r\n        var _this = this;\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        this.nRecordTimeReal = 0;\r\n        this.strVideoPatch = \"\";\r\n        Laya.timer.once(200, this, function () {\r\n            platform.getGameRecorderManager().start({ duration: _this.nRecordTime });\r\n        });\r\n        Laya.timer.loop(1000, this, this.timeStopVideo);\r\n        console.log(\"开始录制视频\");\r\n    };\r\n    MiniManeger_Als.prototype.timeStopVideo = function () {\r\n        this.nRecordTimeReal += 1000;\r\n        if (this.nRecordTimeReal >= this.nRecordTime * 1000) {\r\n            this.StopVideo();\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.StopVideo = function () {\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        EventMgr.getInstance().sendEvent(GameEvent_Als.CHANGE_VIDEO_IMAGE);\r\n        platform.getGameRecorderManager().stop();\r\n        Laya.timer.clear(this, this.timeStopVideo);\r\n        console.log(\"停止录制视频  this.nRecordTimeReal=\", this.nRecordTimeReal);\r\n    };\r\n    MiniManeger_Als.prototype.shareGameVideo = function (data) {\r\n        if (!this.strVideoPatch || this.strVideoPatch.length == 0) {\r\n            TipsManager.getInstance().showDefaultTips(\"暂未录制视频哦!\");\r\n            return;\r\n        }\r\n        if (this.nRecordTimeReal <= 3000) {\r\n            TipsManager.getInstance().showDefaultTips(\"录制视频失败\");\r\n            data.failFun && data.failFun();\r\n            return;\r\n        }\r\n        if (!DeviceUtil.isTTMiniGame()) {\r\n            return;\r\n        }\r\n        console.log(\"分享游戏视频--\");\r\n        var obj = {};\r\n        obj.title = \"阿罗斯营救\";\r\n        obj.query = \"openId=\" + Als_GameData.getInstance().userInfo.openId + \"&nick=\" + Als_GameData.getInstance().userInfo.nick;\r\n        obj.videoPath = this.strVideoPatch;\r\n        obj.success = function () {\r\n            console.log(\"视频分享成功！\");\r\n            TipsManager.getInstance().showDefaultTips(\"发布录制视频成功\");\r\n            data.successFun && data.successFun();\r\n        };\r\n        obj.fail = function (res) {\r\n            console.log(\"视频分享失败！\", res);\r\n            data.failFun && data.failFun();\r\n            TipsManager.getInstance().showDefaultTips(\"发布录制视频失败\");\r\n        };\r\n        platform.shareVideo(obj);\r\n    };\r\n    MiniManeger_Als.prototype.onShareVideo = function (data) {\r\n        this.shareGameVideo(data);\r\n    };\r\n    MiniManeger_Als.prototype.showInterstitialAd = function () {\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            var info = platform.getSystemInfoSync();\r\n            if (info.appName.toUpperCase() == 'DOUYIN') {\r\n                return;\r\n            }\r\n            platform.createInterstitialAd({ adUnitId: \"h7n4g8mhqfp1h56aim\" });\r\n            console.log(\"to show createInterstitialAd!\");\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.showInsertAd = function (data) {\r\n        var _this = this;\r\n        if (this.compareVersion(this.systemInfo.SDKVersion, \"1.12.0\") >= 0) {\r\n            var intersId = [\"c072ba25da29c0b3ec72b379b072f8ee\"];\r\n            if (intersId.length <= 0) {\r\n                data.closeFun && data.closeFun();\r\n                return;\r\n            }\r\n            ViewChangeManager_Als.getInstance().showBufferLoadingView();\r\n            var adId_1 = intersId[Math.floor(Math.random() * intersId.length)];\r\n            console.log(\"创建插屏广告组件-->\", adId_1);\r\n            var createCall = function () {\r\n                _this.insertAd = qq.createInterstitialAd({\r\n                    adUnitId: adId_1\r\n                });\r\n                _this.insertAd.onError(errorCall_1);\r\n                _this.insertAd.onLoad(loadCall_1);\r\n            };\r\n            var loadCall_1 = function (res) {\r\n                console.log(\"插屏广告 加载成功\", res);\r\n                _this.insertAd.offError(errorCall_1);\r\n                _this.insertAd.offLoad(loadCall_1);\r\n                showCall_1();\r\n                ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n            };\r\n            var showCall_1 = function () {\r\n                _this.insertAd.show().then(function () {\r\n                    console.log(\"插屏广告 显示成功\");\r\n                    data.successFun && data.successFun();\r\n                    ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n                }).catch(function (err) {\r\n                    console.warn(\"插屏广告 显示失败\", err);\r\n                    ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n                    errorCall_1(err);\r\n                });\r\n            };\r\n            var closeCall_1 = function (res) {\r\n                console.log(\"插屏广告关闭\", res);\r\n                data.closeFun && data.closeFun();\r\n                if (_this.insertAd) {\r\n                    _this.insertAd.offLoad(loadCall_1);\r\n                    _this.insertAd.offError(errorCall_1);\r\n                    _this.insertAd.offClose(closeCall_1);\r\n                    _this.insertAd.destroy();\r\n                }\r\n                _this.insertAd = null;\r\n                ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n            };\r\n            var errorCall_1 = function (err) {\r\n                console.log(\"插屏广告错误\", err);\r\n                data.errorFun && data.errorFun();\r\n                if (_this.insertAd) {\r\n                    _this.insertAd.offError(errorCall_1);\r\n                    _this.insertAd.offClose(closeCall_1);\r\n                    _this.insertAd.destroy && _this.insertAd.destroy();\r\n                }\r\n                _this.insertAd = null;\r\n                ViewChangeManager_Als.getInstance().hideBufferLoadingView();\r\n            };\r\n            if (!this.insertAd) {\r\n                createCall();\r\n            }\r\n            else {\r\n                showCall_1();\r\n            }\r\n            this.insertAd.onClose(closeCall_1);\r\n        }\r\n        else {\r\n            qq.showModal({\r\n                title: \"提示\",\r\n                content: \"当前QQ版本过低，无法使用插屏广告，请升级到最新QQ版本后重试。\"\r\n            });\r\n        }\r\n    };\r\n    MiniManeger_Als.prototype.showMoreGamesModal = function () {\r\n        var appLaunchOptions = [];\r\n        for (var i = 0, len = Als_GameData.getInstance().weCatMiniIconsInfo.length; i < len; i++) {\r\n            appLaunchOptions.push({\r\n                appId: Als_GameData.getInstance().weCatMiniIconsInfo[i].ad_appid,\r\n                query: \"\",\r\n                extraData: {}\r\n            });\r\n        }\r\n        platform.showMoreGamesModal({\r\n            appLaunchOptions: appLaunchOptions,\r\n            success: function (res) {\r\n                console.log(\"success\", res.errMsg);\r\n            },\r\n            fail: function (res) {\r\n                console.log(\"fail\", res.errMsg);\r\n            },\r\n            complete: function (res) {\r\n                console.log(\"complete\", res.errMsg);\r\n            }\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.createGuessLike = function (parent) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return tslib_1.__generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\r\n                        var data, guessLike;\r\n                        return tslib_1.__generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    data = PlatformDY.gameListInfos;\r\n                                    if (data == null) {\r\n                                        data = Als_GameData.getInstance().weCatMiniIconsInfo;\r\n                                    }\r\n                                    if (!(data && data.length <= 0)) return [3, 2];\r\n                                    return [4, PlatformDY.getGameList()];\r\n                                case 1:\r\n                                    data = _a.sent();\r\n                                    _a.label = 2;\r\n                                case 2:\r\n                                    if (data == null) {\r\n                                        resolve(null);\r\n                                        return [2];\r\n                                    }\r\n                                    guessLike = null;\r\n                                    if (data.length <= 0) {\r\n                                        resolve(guessLike);\r\n                                        return [2];\r\n                                    }\r\n                                    console.log(\"data(GuessLike) ->\", data);\r\n                                    guessLike = parent.getChildByName('GuessLike');\r\n                                    if (guessLike == null) {\r\n                                        guessLike = new GuessLike_Als(\"game/uiView/GuessLike.json\", \"game/uiView/GuessLikeItem.json\", data, 240);\r\n                                        parent.addChild(guessLike);\r\n                                    }\r\n                                    guessLike.name = 'GuessLike';\r\n                                    guessLike.mouseThrough = true;\r\n                                    guessLike.x = (Laya.stage.width - guessLike.width) / 2;\r\n                                    guessLike.y = Laya.stage.height - guessLike.height;\r\n                                    resolve(guessLike);\r\n                                    return [2];\r\n                            }\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.reportMonitorSome = function (name, value) {\r\n    };\r\n    MiniManeger_Als.prototype.wxPushMsg = function () {\r\n        if (this.bPushMsgShowFlagTen && this.bPushMsgShowFlagChooseLevel) {\r\n            return;\r\n        }\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            window[\"wx\"].requestSubscribeMessage({\r\n                tmplIds: [\"lLzwoD67W2rWzLRHR-gSd2mHbKukPycirB99W8pe9e0\"],\r\n                success: function (res) {\r\n                    console.log(res);\r\n                    var str = res[\"lLzwoD67W2rWzLRHR-gSd2mHbKukPycirB99W8pe9e0\"];\r\n                    console.log(\"str = \", str);\r\n                    if (str == \"accept\") {\r\n                        MiniManeger_Als.saveOpenID();\r\n                    }\r\n                }, fail: function (e) {\r\n                    console.log(\"1\", e);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    MiniManeger_Als.saveOpenID = function () {\r\n        var gameId = Als_GameData.getInstance().gameId;\r\n        var openId = Als_GameData.getInstance().strOpenIDWx;\r\n        var strPl = \"WeCat\";\r\n        var msg = {};\r\n        msg.msg_type = \"26\";\r\n        msg.msg_data = {\r\n            \"gameid\": gameId,\r\n            \"openid\": openId,\r\n            \"platform\": strPl\r\n        };\r\n        HttpMgr.getInstance().sendHttp(MiniManeger_Als.URLPUSHMSG, msg, MiniManeger_Als.saveOpenIDSuccess, MiniManeger_Als.saveOpenIDFaild);\r\n    };\r\n    MiniManeger_Als.saveOpenIDSuccess = function (data) {\r\n        var code = data[\"error_code\"];\r\n        if (code == \"0\") {\r\n            console.warn(\"saveOpenID Success!\");\r\n        }\r\n        else {\r\n            console.warn(\"saveOpenID Faild!\");\r\n        }\r\n    };\r\n    MiniManeger_Als.saveOpenIDFaild = function () {\r\n    };\r\n    MiniManeger_Als.prototype.checkCityInfo = function () {\r\n        if (!BaseConst.infos.gameInfo.region) {\r\n            return;\r\n        }\r\n        if (!DeviceUtil.isQQMiniGame()) {\r\n            return;\r\n        }\r\n        HttpMgr.getInstance().sendHttpTemp(this.strApiUrl, null, function (data) {\r\n            console.log(\"regioninfo = \", data);\r\n            var strRegion = data;\r\n            var nLen = BaseConst.infos.gameInfo.region.length;\r\n            var strDataTemp = \"\";\r\n            for (var i = 0; i < nLen; ++i) {\r\n                strDataTemp = BaseConst.infos.gameInfo.region[i];\r\n                if (strRegion.indexOf(strDataTemp) != -1) {\r\n                    BaseConst.infos.gameInfo.succShowBox = 0;\r\n                    BaseConst.infos.gameInfo.siginC = 0;\r\n                    BaseConst.infos.gameInfo.boxWDJ = 0;\r\n                    break;\r\n                }\r\n            }\r\n        }, function () {\r\n        });\r\n    };\r\n    MiniManeger_Als.prototype.isWxMiniGameForOperReq = function () {\r\n        return DeviceUtil.isWXMiniGame();\r\n    };\r\n    MiniManeger_Als.URLPUSHMSG = \"https://littlegame.32yx.com/SaveOpenID.fcgi\";\r\n    return MiniManeger_Als;\r\n}());\r\nexport { MiniManeger_Als };\r\n",
  "references": [
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/GameData.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/manager/InviteManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/SoundManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/GameDataManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/ConfigManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/CommonDefine.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/ViewChangeManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/GameEvent.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/PlatformDY.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/views/game/GuessLike.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/base/net/HttpMgr.ts"
  ]
}
