{
  "code": "var HttpMgr = (function () {\r\n    function HttpMgr() {\r\n        this.printLog = true;\r\n        this.defaultTimeOut = 5000;\r\n    }\r\n    HttpMgr.getInstance = function () {\r\n        if (!HttpMgr.instance_) {\r\n            HttpMgr.instance_ = new HttpMgr();\r\n        }\r\n        return HttpMgr.instance_;\r\n    };\r\n    HttpMgr.prototype.sendHttp = function (url, data, secces, fail, type, responseType) {\r\n        var _this = this;\r\n        if (data === void 0) { data = null; }\r\n        if (secces === void 0) { secces = null; }\r\n        if (fail === void 0) { fail = null; }\r\n        if (type === void 0) { type = \"post\"; }\r\n        if (responseType === void 0) { responseType = \"text\"; }\r\n        console.log(\"url ->\", url);\r\n        var jsonStr = data ? JSON.stringify(data) : \"null\";\r\n        if (this.printLog) {\r\n            var date = new Date();\r\n            console.log(\"HTTP Send :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]  \\n    send data: \" + jsonStr);\r\n        }\r\n        var httpRequest = Laya.Pool.getItemByClass(\"HttpRequest\", Laya.HttpRequest);\r\n        httpRequest.http.timeout = this.defaultTimeOut;\r\n        httpRequest.http.ontimeout = function () {\r\n            console.log('ontimeout');\r\n            if (fail) {\r\n                fail(null);\r\n                TipsManager.getInstance().showDefaultTips(\"网络请求超时！\");\r\n            }\r\n            httpRequest.http.ontimeout = null;\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        };\r\n        httpRequest.once(Laya.Event.COMPLETE, this, function (rev) {\r\n            if (secces) {\r\n                secces(JSON.parse(rev));\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.once(Laya.Event.ERROR, this, function (e) {\r\n            if (_this.printLog) {\r\n                var date = new Date();\r\n                console.log(\"HTTP Error :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]\");\r\n            }\r\n            if (fail) {\r\n                fail(e);\r\n                TipsManager.getInstance().showDefaultTips(\"你的网络已断开，请检查设置。\");\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.send(url, data ? jsonStr : null, type, \"text\");\r\n    };\r\n    HttpMgr.prototype.sendHttpDY = function (url, data, secces, fail, type, responseType) {\r\n        var _this = this;\r\n        if (data === void 0) { data = null; }\r\n        if (secces === void 0) { secces = null; }\r\n        if (fail === void 0) { fail = null; }\r\n        if (type === void 0) { type = \"post\"; }\r\n        if (responseType === void 0) { responseType = \"text\"; }\r\n        if (type == \"get\" && data) {\r\n            url += Utils.querStr(data);\r\n        }\r\n        console.log(\"url ->\", url);\r\n        var jsonStr = data ? JSON.stringify(data) : \"null\";\r\n        if (this.printLog) {\r\n            var date = new Date();\r\n            console.log(\"HTTP Send :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]  \\n    send data: \" + jsonStr);\r\n        }\r\n        var httpRequest = Laya.Pool.getItemByClass(\"HttpRequest\", Laya.HttpRequest);\r\n        httpRequest.http.timeout = this.defaultTimeOut;\r\n        httpRequest.http.ontimeout = function () {\r\n            console.log(\"ontimeout\");\r\n            if (fail) {\r\n                fail(null);\r\n                TipsManager.getInstance().showDefaultTips(\"网络请求超时！\");\r\n            }\r\n            httpRequest.http.ontimeout = null;\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        };\r\n        httpRequest.once(Laya.Event.COMPLETE, this, function (rev) {\r\n            if (secces) {\r\n                secces(JSON.parse(rev));\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.once(Laya.Event.ERROR, this, function (e) {\r\n            if (_this.printLog) {\r\n                var date = new Date();\r\n                console.log(\"HTTP Error :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]\");\r\n            }\r\n            if (fail) {\r\n                fail(e);\r\n                TipsManager.getInstance().showDefaultTips(\"你的网络已断开，请检查设置。\");\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        if (type == \"get\") {\r\n            httpRequest.send(url);\r\n            return;\r\n        }\r\n        httpRequest.send(url, data ? jsonStr : null, \"post\", \"text\");\r\n    };\r\n    HttpMgr.prototype.sendPostHttp = function (url, data, secces, fail, type, showParse) {\r\n        var _this = this;\r\n        if (data === void 0) { data = null; }\r\n        if (secces === void 0) { secces = null; }\r\n        if (fail === void 0) { fail = null; }\r\n        if (type === void 0) { type = \"post\"; }\r\n        if (showParse === void 0) { showParse = true; }\r\n        console.log(\"url ->\", url);\r\n        var param;\r\n        if (showParse) {\r\n            param = this.getEncodeParam(data);\r\n        }\r\n        param = data;\r\n        var httpRequest = Laya.Pool.getItemByClass(\"HttpRequest\", Laya.HttpRequest);\r\n        httpRequest.http.timeout = this.defaultTimeOut;\r\n        httpRequest.http.ontimeout = function () {\r\n            console.log('ontimeout');\r\n            if (fail) {\r\n                fail(null);\r\n                TipsManager.getInstance().showDefaultTips(\"网络请求超时！\");\r\n            }\r\n            httpRequest.http.ontimeout = null;\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        };\r\n        httpRequest.once(Laya.Event.COMPLETE, this, function (rev) {\r\n            if (secces) {\r\n                secces(rev);\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.once(Laya.Event.ERROR, this, function (e) {\r\n            if (_this.printLog) {\r\n                var date = new Date();\r\n                console.log(\"HTTP Error :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]\");\r\n            }\r\n            if (fail) {\r\n                fail(e);\r\n                TipsManager.getInstance().showDefaultTips(\"你的网络已断开，请检查设置。\");\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.send(url, param, type, \"json\");\r\n    };\r\n    HttpMgr.prototype.sendGetHttp = function (url, data, secces, fail, type, responseType) {\r\n        var _this = this;\r\n        if (data === void 0) { data = null; }\r\n        if (secces === void 0) { secces = null; }\r\n        if (fail === void 0) { fail = null; }\r\n        if (type === void 0) { type = \"get\"; }\r\n        if (responseType === void 0) { responseType = \"json\"; }\r\n        console.log(\"url ->\", url);\r\n        var jsonStr = data ? JSON.stringify(data) : \"null\";\r\n        var param = '';\r\n        param = this.getEncodeParam(data);\r\n        if (this.printLog) {\r\n            var date = new Date();\r\n            console.log(\"HTTP Send :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]  \\n    send data: \" + jsonStr);\r\n        }\r\n        var httpRequest = Laya.Pool.getItemByClass(\"HttpRequest\", Laya.HttpRequest);\r\n        httpRequest.http.timeout = this.defaultTimeOut;\r\n        var httpRequests = httpRequest.http;\r\n        httpRequests.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n        httpRequest.http.ontimeout = function () {\r\n            console.log('ontimeout');\r\n            if (fail) {\r\n                fail(null);\r\n                TipsManager.getInstance().showDefaultTips(\"网络请求超时！\");\r\n            }\r\n            httpRequest.http.ontimeout = null;\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        };\r\n        httpRequest.once(Laya.Event.COMPLETE, this, function (rev) {\r\n            if (secces) {\r\n                secces(JSON.parse(rev));\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.once(Laya.Event.ERROR, this, function (e) {\r\n            if (_this.printLog) {\r\n                var date = new Date();\r\n                console.log(\"HTTP Error :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]\");\r\n            }\r\n            if (fail) {\r\n                fail(e);\r\n                TipsManager.getInstance().showDefaultTips(\"你的网络已断开，请检查设置。\");\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.send(url + param, param, type, \"text\");\r\n    };\r\n    HttpMgr.prototype.getEncodeParam = function (data) {\r\n        var param = '';\r\n        if (data) {\r\n            if (data instanceof String) {\r\n                return data;\r\n            }\r\n            var arr = [];\r\n            for (var obj in data) {\r\n                arr.push(obj + '=' + data[obj]);\r\n            }\r\n            param = arr.join('&');\r\n        }\r\n        return param;\r\n    };\r\n    HttpMgr.prototype.sendHttpTemp = function (url, data, secces, fail, type, responseType) {\r\n        var _this = this;\r\n        if (data === void 0) { data = null; }\r\n        if (secces === void 0) { secces = null; }\r\n        if (fail === void 0) { fail = null; }\r\n        if (type === void 0) { type = \"post\"; }\r\n        if (responseType === void 0) { responseType = \"text\"; }\r\n        console.log(\"url ->\", url);\r\n        var jsonStr = data ? JSON.stringify(data) : \"null\";\r\n        if (this.printLog) {\r\n            var date = new Date();\r\n            console.log(\"HTTP Send :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]  \\n    send data: \" + jsonStr);\r\n        }\r\n        var httpRequest = Laya.Pool.getItemByClass(\"HttpRequest\", Laya.HttpRequest);\r\n        httpRequest.http.timeout = this.defaultTimeOut;\r\n        httpRequest.http.ontimeout = function () {\r\n            console.log('ontimeout');\r\n            if (fail) {\r\n                fail(null);\r\n                TipsManager.getInstance().showDefaultTips(\"网络请求超时！\");\r\n            }\r\n            httpRequest.http.ontimeout = null;\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        };\r\n        httpRequest.once(Laya.Event.COMPLETE, this, function (rev) {\r\n            if (secces) {\r\n                secces(rev);\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.once(Laya.Event.ERROR, this, function (e) {\r\n            if (_this.printLog) {\r\n                var date = new Date();\r\n                console.log(\"HTTP Error :[\" + date.toTimeString() + \" time:\" + date.getTime() + \"]\");\r\n            }\r\n            if (fail) {\r\n                fail(e);\r\n                TipsManager.getInstance().showDefaultTips(\"你的网络已断开，请检查设置。\");\r\n            }\r\n            Laya.Pool.recover(\"HttpRequest\", httpRequest);\r\n        });\r\n        httpRequest.send(url, data ? jsonStr : null, type, \"text\");\r\n    };\r\n    return HttpMgr;\r\n}());\r\nexport { HttpMgr };\r\n",
  "references": []
}
