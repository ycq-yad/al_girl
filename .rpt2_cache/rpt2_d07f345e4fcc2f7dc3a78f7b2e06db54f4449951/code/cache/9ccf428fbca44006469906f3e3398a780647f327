{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport GameStateManager_Als from \"../games/GameStateManager\";\r\nimport { EnterGameType } from \"../games/CommonDefine\";\r\nimport ViewChangeManager_Als from \"../games/ViewChangeManager\";\r\nimport GameEvent_Als from \"../games/GameEvent\";\r\nimport { PlayerDataManager_Als } from \"../common/GameDataManager\";\r\nimport Als_SoundManager from \"../common/SoundManager\";\r\nimport { MiniManeger_Als } from \"../minigame/MiniManeger\";\r\nimport MiniEventConst_Als from \"../minigame/MiniEventConst\";\r\nimport WeCatMoreGameView_Als from \"./game/WeCatMoreGameView\";\r\nvar GameView_Als = (function (_super) {\r\n    tslib_1.__extends(GameView_Als, _super);\r\n    function GameView_Als() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"GameView\";\r\n        _this.bg_img_res = null;\r\n        _this.chooseLeft = null;\r\n        _this.bHanderAniShow = false;\r\n        _this.bIsRunning = false;\r\n        _this.bLevelOver = false;\r\n        _this.skin = \"game/GameView.json\";\r\n        return _this;\r\n    }\r\n    GameView_Als.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        var self = this;\r\n        if (!self.guessLike && MiniManeger_Als.instance.isWxMiniGameForOperReq() && BaseConst.infos.gameInfo.openPsAward == 1) {\r\n            MiniManeger_Als.instance.createGuessLike(self).then(function (guessLike) {\r\n                if (!guessLike) {\r\n                    return;\r\n                }\r\n                self.guessLike = guessLike;\r\n                self.guessLike.x = (Laya.stage.width - self.guessLike.width) / 2;\r\n                self.guessLike.y = 300;\r\n            });\r\n        }\r\n    };\r\n    GameView_Als.prototype.onAddStage = function () {\r\n        MiniManeger_Als.instance.showInterstitialAd();\r\n        EventMgr.getInstance().addEvent(GameEvent_Als.CHANGE_VIDEO_IMAGE, this, this.stopVideoImage);\r\n        this.initView();\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            MiniManeger_Als.instance.hideBanner();\r\n        }\r\n        else if (DeviceUtil.isQQMiniGame()) {\r\n            MiniManeger_Als.instance.showBannerAd();\r\n        }\r\n        else if (DeviceUtil.isWXMiniGame()) {\r\n            MiniManeger_Als.instance.showBannerAd();\r\n        }\r\n    };\r\n    GameView_Als.prototype.onEnable = function () {\r\n        var _this = this;\r\n        if (MiniManeger_Als.instance.isWxMiniGameForOperReq()) {\r\n            if (PlayerDataManager_Als.getInstance().isSecondEnterGame()) {\r\n                Laya.timer.once(1000, this, function () {\r\n                    _this.pWeCatMoreGameView = ViewManager.getInstance().showView(WeCatMoreGameView_Als);\r\n                    _this.addEvent();\r\n                    _this.imageWeCatMoreGame.visible = true;\r\n                });\r\n            }\r\n            else {\r\n                this.imageWeCatMoreGame.visible = true;\r\n                this.addEvent();\r\n            }\r\n        }\r\n        else {\r\n            this.addEvent();\r\n        }\r\n    };\r\n    GameView_Als.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        this.bIsRunning = false;\r\n        Laya.Tween.clearAll(this.imageBtTip);\r\n        Laya.timer.clearAll(this);\r\n    };\r\n    GameView_Als.prototype.initView = function () {\r\n        this.initPlView();\r\n        this.bLevelOver = false;\r\n        this.bIsRunning = true;\r\n        this.refreshChoose();\r\n        this.startimageBtTipAni();\r\n        this.imageBtTip.visible = false;\r\n        this.imageBtGotoNextLevel.visible = false;\r\n    };\r\n    GameView_Als.prototype.refreshChoose = function () {\r\n        this.box_choose.visible = false;\r\n        this.initViewInfo();\r\n    };\r\n    GameView_Als.prototype.addEvent = function () {\r\n        this.imageBtToHome.on(Laya.Event.CLICK, this, this.returnToGameHome);\r\n        this.imageBtTip.on(Laya.Event.CLICK, this, this.onGameViewShareGame);\r\n        this.imageBtRestart.on(Laya.Event.CLICK, this, this.gameViewRestartGame);\r\n        this.imageBtGotoNextLevel.on(Laya.Event.CLICK, this, this.onGameViewWatchVideoNextLevel);\r\n        this.imageWeCatMoreGame.on(Laya.Event.CLICK, this, this.weCatViewOper);\r\n    };\r\n    GameView_Als.prototype.removeEvent = function () {\r\n        this.imageBtToHome.off(Laya.Event.CLICK, this, this.returnToGameHome);\r\n        this.icon_chooseLeft.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.icon_chooseRight.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.imageBtTip.off(Laya.Event.CLICK, this, this.onGameViewShareGame);\r\n        this.imageBtRestart.off(Laya.Event.CLICK, this, this.gameViewRestartGame);\r\n        this.imageBtGotoNextLevel.off(Laya.Event.CLICK, this, this.onGameViewWatchVideoNextLevel);\r\n        EventMgr.getInstance().removeEvent(GameEvent_Als.CHANGE_VIDEO_IMAGE, this, this.stopVideoImage);\r\n        this.imageWeCatMoreGame.off(Laya.Event.CLICK, this, this.weCatViewOper);\r\n    };\r\n    GameView_Als.prototype.weCatViewOper = function () {\r\n        this.pWeCatMoreGameView = ViewManager.getInstance().showView(WeCatMoreGameView_Als);\r\n    };\r\n    GameView_Als.prototype.closeWeCatMoreGameView = function () {\r\n        if (WeCatMoreGameView_Als.isOpen && this.pWeCatMoreGameView) {\r\n            this.pWeCatMoreGameView.removeSelf();\r\n        }\r\n    };\r\n    GameView_Als.prototype.onGameViewWatchVideoNextLevel = function () {\r\n        var _this = this;\r\n        MiniManeger_Als.instance.reportMonitorSome(MiniEventConst_Als.GAME_UP, 1);\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        this.imageBtGotoNextLevel.off(Laya.Event.CLICK, this, this.onGameViewWatchVideoNextLevel);\r\n        MiniManeger_Als.instance.playViderAd({\r\n            successFun: function () {\r\n                _this.onGameViewNextLevel();\r\n                _this.imageBtGotoNextLevel.on(Laya.Event.CLICK, _this, _this.onGameViewWatchVideoNextLevel);\r\n            },\r\n            failFun: function () {\r\n                _this.imageBtGotoNextLevel.on(Laya.Event.CLICK, _this, _this.onGameViewWatchVideoNextLevel);\r\n            },\r\n            errorFun: function () {\r\n                _this.imageBtGotoNextLevel.on(Laya.Event.CLICK, _this, _this.onGameViewWatchVideoNextLevel);\r\n            }\r\n        });\r\n    };\r\n    GameView_Als.prototype.onGameViewNextLevel = function () {\r\n        if (this.bLevelOver) {\r\n            return;\r\n        }\r\n        ViewChangeManager_Als.getInstance().goToNextLevel();\r\n    };\r\n    GameView_Als.prototype.gameViewRestartGame = function () {\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        if (this.bLevelOver) {\r\n            return;\r\n        }\r\n        ViewChangeManager_Als.getInstance().restartGame(true);\r\n    };\r\n    GameView_Als.prototype.returnToGameHome = function () {\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        GameStateManager_Als.getInstance().levelState = EnterGameType.enum_EnterGameType_GameHome;\r\n        ViewChangeManager_Als.getInstance().CurLevelBase.returnToGameHome();\r\n        this.removeSelf();\r\n    };\r\n    GameView_Als.prototype.onClick = function (evt) {\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        var tar = evt.currentTarget;\r\n        var data = this.viewData_.data;\r\n        var icon_name = '';\r\n        switch (evt.currentTarget) {\r\n            case this.icon_chooseLeft:\r\n                icon_name = data.chooseLeftName;\r\n                this.chooseLeft = 'left';\r\n                this.icon_chooseRight.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n                break;\r\n            case this.icon_chooseRight:\r\n                icon_name = data.chooseRightName;\r\n                this.chooseLeft = 'right';\r\n                this.icon_chooseLeft.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n                break;\r\n        }\r\n        this.viewData_.callBack(icon_name == data.rightName, icon_name);\r\n        tar.skin = 'resource/assets/img/level/baseboard2.png';\r\n        this.imageBtTip.visible = false;\r\n        this.imageBtGotoNextLevel.visible = false;\r\n    };\r\n    GameView_Als.prototype.showResultIcon = function (isRight) {\r\n        var _this = this;\r\n        this.createChooseAnswer(isRight);\r\n        if (isRight) {\r\n            Als_SoundManager.getInstance().playEffect(\"right\", 1);\r\n            Laya.timer.once(1000, this, function () {\r\n                _this.hideChoseView();\r\n            });\r\n        }\r\n        else {\r\n            Als_SoundManager.getInstance().playEffect(\"wrong\", 1);\r\n        }\r\n    };\r\n    GameView_Als.prototype.createChooseAnswer = function (isRight) {\r\n        var tar;\r\n        var skin = 'resource/assets/img/choose/gameinterface_icon_4.png';\r\n        if (!isRight) {\r\n            skin = 'resource/assets/img/choose/gameinterface_icon_5.png';\r\n        }\r\n        if (this.chooseLeft == 'left') {\r\n            tar = this.icon_left;\r\n        }\r\n        else {\r\n            tar = this.icon_right;\r\n        }\r\n        var img = new Laya.Image();\r\n        img.skin = skin;\r\n        img.centerX = img.centerY = 0;\r\n        tar.addChild(img);\r\n    };\r\n    GameView_Als.prototype.showChoseView = function (data) {\r\n        this.imageBtTip.visible = true;\r\n        this.imageBtGotoNextLevel.visible = true;\r\n        this.initViewInfo();\r\n        this.viewData_ = data;\r\n        this.box_choose.visible = true;\r\n        this.refreshViewChose();\r\n        this.icon_chooseLeft.once(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.icon_chooseRight.once(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.imageWeCatMoreGame.off(Laya.Event.CLICK, this, this.weCatViewOper);\r\n    };\r\n    GameView_Als.prototype.hideChoseView = function () {\r\n        this.imageBtTip.visible = false;\r\n        this.imageBtGotoNextLevel.visible = false;\r\n        Laya.Tween.to(this.box_choose, { scaleX: 0, scaleY: 0 }, 500, Laya.Ease.backIn);\r\n        this.box_choose.visible = false;\r\n        this.icon_chooseLeft.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.icon_chooseRight.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        this.initViewInfo();\r\n        this.imageWeCatMoreGame.on(Laya.Event.CLICK, this, this.weCatViewOper);\r\n    };\r\n    GameView_Als.prototype.refreshViewChose = function () {\r\n        this.box_choose.scale(0.2, 0.2);\r\n        Laya.Tween.to(this.box_choose, { scaleX: 1, scaleY: 1 }, 500, Laya.Ease.backIn);\r\n        this.icon_chooseRight.skin = 'resource/assets/img/level/baseboard1.png';\r\n        this.icon_left.removeChildren();\r\n        this.icon_chooseRight.removeChildren();\r\n        this.icon_right.removeChildren();\r\n        this.icon_chooseLeft.skin = 'resource/assets/img/level/baseboard1.png';\r\n        this.icon_chooseLeft.removeChildren();\r\n        this.icon_left.skin = 'resource/assets/img/choose/' + this.viewData_.data.icon_chooseLeft + '.png';\r\n        this.icon_right.skin = 'resource/assets/img/choose/' + this.viewData_.data.icon_chooseRight + '.png';\r\n    };\r\n    GameView_Als.prototype.removeSelf = function () {\r\n        return _super.prototype.removeSelf.call(this);\r\n    };\r\n    GameView_Als.prototype.refreshUpIndeInfo = function (nIndexCur, nIndexMax) {\r\n        var nIndexTemp = 0;\r\n        var nCur = PlayerDataManager_Als.getInstance().stPlayerDataBase.nCurLevel;\r\n        nCur = nCur >= PlayerDataManager_Als.getInstance().nMaxLevelCount ? PlayerDataManager_Als.getInstance().getCurLevelMax() - 1 : nCur;\r\n        if (!PlayerDataManager_Als.getInstance().allCustomsClearance()) {\r\n            this.spLevelLeft.visible = true;\r\n            this.spLevelRight.visible = true;\r\n            BitmapLabelUtils.setLabel(this.spLevelLeft, (nCur + 1).toString(), \"resource/assets/img/ui/game/gameinterface_number1/gameinterface_number1_\", 0, \".png\", \"center\");\r\n            BitmapLabelUtils.setLabel(this.spLevelRight, (nCur + 2).toString(), \"resource/assets/img/ui/game/gameinterface_number1/gameinterface_number1_\", 0, \".png\", \"center\");\r\n        }\r\n        else {\r\n            this.spLevelLeft.visible = false;\r\n            this.spLevelRight.visible = false;\r\n        }\r\n        var nCount = this.hBoxIndex.numChildren;\r\n        for (var i = 0; i < nCount; ++i) {\r\n            var stImageInfo = this.hBoxIndex.getChildAt(i);\r\n            if (stImageInfo) {\r\n                if (i < nIndexMax) {\r\n                    stImageInfo.visible = true;\r\n                }\r\n                else {\r\n                    stImageInfo.visible = false;\r\n                }\r\n                var pImageFinish = stImageInfo.getChildAt(0);\r\n                if (pImageFinish) {\r\n                    if (i < nIndexCur) {\r\n                        pImageFinish.visible = true;\r\n                        ++nIndexTemp;\r\n                    }\r\n                    else {\r\n                        pImageFinish.visible = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (nIndexTemp >= nIndexMax) {\r\n            this.bLevelOver = true;\r\n        }\r\n        this.boxLevelInfo.width = 108 + 20 + this.hBoxIndex.width + 20 + 108;\r\n    };\r\n    GameView_Als.prototype.onGameViewShareGame = function () {\r\n        MiniManeger_Als.instance.reportMonitorSome(MiniEventConst_Als.GAME_TIP, 1);\r\n        Als_SoundManager.getInstance().playEffect(\"button\", 1);\r\n        if (!this.box_choose.visible && !this.bHanderAniShow) {\r\n            console.log(\"box choose not show!\");\r\n            return;\r\n        }\r\n        var self = this;\r\n        MiniManeger_Als.instance.bFlagDouYin = false;\r\n        MiniManeger_Als.instance.shareAppMessage({\r\n            sucFun: function () {\r\n                self.onShareGameSuccess();\r\n            }\r\n        });\r\n    };\r\n    GameView_Als.prototype.onShareGameSuccess = function () {\r\n        var data = ViewChangeManager_Als.getInstance().CurLevelBase.getCurChooseInfo();\r\n        var nHandX = 0;\r\n        var nHandY = 0;\r\n        if (!data) {\r\n            return;\r\n        }\r\n        if (data.chooseLeftName == data.rightName) {\r\n            this.icon_chooseRight.skin = 'resource/assets/img/level/baseboard2.png';\r\n            this.icon_chooseRight.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n            nHandX = this.icon_chooseLeft.x + this.icon_chooseLeft.width / 2;\r\n            nHandY = this.icon_chooseLeft.y + this.icon_chooseLeft.height / 2;\r\n        }\r\n        else {\r\n            this.icon_chooseLeft.skin = 'resource/assets/img/level/baseboard2.png';\r\n            nHandX = this.icon_chooseRight.x + this.icon_chooseRight.width / 2;\r\n            nHandY = this.icon_chooseRight.y + this.icon_chooseRight.height / 2;\r\n            this.icon_chooseLeft.off(Laya.Event.MOUSE_DOWN, this, this.onClick);\r\n        }\r\n        this.imageHand.x = nHandX;\r\n        this.imageHand.y = nHandY;\r\n        this.bHanderAniShow = true;\r\n        this.imageHand.visible = true;\r\n        this.handAni();\r\n    };\r\n    GameView_Als.prototype.handAni = function () {\r\n        var _this = this;\r\n        if (!this.bHanderAniShow) {\r\n            return;\r\n        }\r\n        this.imageHand.skin = \"resource/assets/img/ui/game/gameinterface_icon_1.png\";\r\n        Laya.timer.once(500, this, function () {\r\n            _this.imageHand.skin = \"resource/assets/img/ui/game/gameinterface_icon_2.png\";\r\n            Laya.timer.once(500, _this, _this.handAni);\r\n        });\r\n    };\r\n    GameView_Als.prototype.initViewInfo = function () {\r\n        this.imageHand.visible = false;\r\n        this.bHanderAniShow = false;\r\n        this.bLevelOver = false;\r\n    };\r\n    GameView_Als.prototype.startimageBtTipAni = function () {\r\n        var _this = this;\r\n        if (!this.bIsRunning) {\r\n            return;\r\n        }\r\n        Laya.Tween.clearAll(this.imageBtTip);\r\n        Laya.Tween.to(this.imageBtTip, { scaleX: 1.1, scaleY: 1.1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(this, function (args) {\r\n            Laya.Tween.to(_this.imageBtTip, { scaleX: 1, scaleY: 1 }, 300, Laya.Ease.sineOut, Laya.Handler.create(_this, function (args) {\r\n                Laya.timer.once(0, _this, _this.startimageBtTipAni);\r\n            }));\r\n        }));\r\n    };\r\n    GameView_Als.prototype.initPlView = function () {\r\n        if (DeviceUtil.isTTMiniGame()) {\r\n            this.imageTTVideo.visible = true;\r\n        }\r\n    };\r\n    GameView_Als.prototype.startVideoImage = function () {\r\n        this.imageTTVideo.skin = \"resource/assets/img/common/gaming_icon_4.png\";\r\n    };\r\n    GameView_Als.prototype.stopVideoImage = function () {\r\n        console.log(\"stopVideoImage\");\r\n        this.imageTTVideo.skin = \"resource/assets/img/common/gaming_icon_5.png\";\r\n    };\r\n    return GameView_Als;\r\n}(BaseSceneUISkinPopView));\r\nexport default GameView_Als;\r\n",
  "references": [
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/GameStateManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/CommonDefine.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/ViewChangeManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/GameEvent.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/GameDataManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/games/ConfigManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/manager/LevelManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/SoundManager.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/minigame/MiniManeger.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/minigame/MiniEventConst.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/views/game/GuessLike.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/views/game/WeCatMoreGameView.ts",
    "E:/laya/project/laya_girl_ts_wecat/src/script/common/GameData.ts"
  ]
}
